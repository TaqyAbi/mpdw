---
title: "Tugas Praktikum 5"
author: "M.Taqy Abiyu Dzakwan"
date: "2025-09-27"
output:
  html_document:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: true
    highlight: tango
    code_folding: show
    toc_depth: 5
    number_sections: false
    theme: flatly
    toc: yes
    toc_float:
      collapsed: true
      smooth_scroll: true
    fig_caption: true
editor_options: 
  markdown: 
    wrap: 72
---

# Pemanggilan Library

```{r}
options(warn = -1)
library(tsibble)
library(ggplot2)
library(rio)
library(tseries)
library(MASS)
library(dplyr)
```

# Data Preparation

```{r}
telur <- read.csv("D:/TUGAS IPB/Semester 5/mpdw/Pertemuan 1/Data/Telur Ayam Ras.csv")
head(telur)
```

```{r}
telur.sub <- telur[320:479, ]
telur.sub$Date <- as.Date(telur.sub$Date)
```

# Plot Time Series

```{r}
plot_telur <- telur.sub %>%
  as_tsibble(index = Date) %>%
  ggplot(aes(x = Date, y = Jawa.Barat)) +
  geom_line(color = "blue") +
  theme_bw() +
  labs(
    title = "Time Series Plot Harga Telur Ayam Ras",
    x = "Tanggal",
    y = "Nilai/Harga"
  )

plot_telur
```

```{r}
mean(telur.sub$Jawa.Barat)
```
```{r}
var(telur.sub$Jawa.Barat)
```
Berdasarkan plot time series tersebut, terlihat bahwa data tidak stasioner dalam rataan, ditandai dengan adanya kecenderungan (tren) negatif, tetapi stasioner dalam ragam, hal ini ditandai dengan lebar pita pada plot yang cenderung sama.


```{r}
lattice::densityplot(as.vector(telur.sub$Jawa.Barat))
```
Plot ini menunjukkan distribusi bimodal, yang berarti harga telur sering terkumpul di dua rentang harga yang berbeda: satu di sekitar harga rendah (26.000-27.000) dan satu lagi di harga tinggi (31.000-32.000). Kehadiran dua puncak cerminan visual dari tren menurun pada data, di mana kelompok harga tinggi mewakili periode awal dan kelompok harga rendah mewakili periode akhir pengamatan. Plot densitas bimodal ini secara visual menegaskan bahwa data ini tidak stasioner dalam rataan. 

#  Plot ACF

```{r}
acf(telur.sub)
```
Plot `ACF` ini menunjukkan bahwa lag autokorelasi menurun dengan sangat lambat, yang merupakan bukti statistik kuat bahwa data ini tidak stasioner. Pola ini terjadi karena adanya tren menurun yang kuat, dimana nilai pada satu waktu sangat berkorelasi positif dengan nilai pada waktu-waktu berikutnya.


# Uji ADF

```{r}
tseries::adf.test(telur.sub$Jawa.Barat)
```
Berdasarkan uji ADF tersebut, didapat p-value lebih besar dari taraf nyata 5% sehingga gagal tolak $H_0$ dan menandakan bahwa `data tidak stasioner dalam rataan`. Hal ini sesuai dengan hasil eksplorasi menggunakan plot time series dan plot ACF.

# Plot Box Cox

```{r}
index_waktu <- 1:nrow(telur.sub)

bc <- boxcox(
  telur.sub$Jawa.Barat ~ index_waktu,
  lambda = seq(-2, 2, by = 0.1)
)
```

```{r}
lambda_terbaik <- bc$x[which.max(bc$y)]
cat("Nilai Lambda Optimal:", lambda_terbaik)
```
```{r}
# Selang kepercayaan 95% untuk lambda
ci_lambda <- bc$x[bc$y > max(bc$y) - 0.5 * qchisq(0.95, 1)]

# Batas bawah dan batas atas
ci_lower <- min(ci_lambda)
ci_upper <- max(ci_lambda)

c(Batas_Bawah = ci_lower, Batas_Atas = ci_upper)
```

# Differencing

```{r}
diff1 <- diff(telur.sub$Jawa.Barat, differences = 1)

ts.plot(diff1,
        main = "Plot Harga Telur Setelah Differencing Orde 1",
        ylab = "Nilai Hasil Differencing",
        col = "blue",
        lwd = 1)

abline(h = 0, col = "red", lty = 2)
```
Terlihat pada plot diatas bahwa data sudah stasioner setelah dilakukan differencing, berikutnya akan dibuktikan dengan melihat plot acf dan uji adf nya.

## ACF
```{r}
acf(diff1)
```
Berdasarkan plot ACF tersebut, data diketahui bahwa data sudah stasioner terhadap rataan. Pola slow decay (penurunan yang sangat lambat) yang sebelumnya ada pada data non-stasioner kini telah hilang. Sebagian besar lag berfluktuasi secara acak di sekitar nol dan berada di dalam batas biru.

## Uji ADF
```{r}
adf.test(diff1)
```
Karena $p-value$ (0.01) jauh lebih kecil dari tingkat signifikansi umum (0.05), kita memiliki bukti statistik yang kuat untuk menolak Hipotesis Nol. Sehingga dapat disimpulkan bahwa data sudah stasioner.

# Partisi Data

```{r}
proporsi_latih <- 0.8

n_total <- length(diff1)
n_latih <- floor(proporsi_latih * n_total)

data_latih <- diff1[1:n_latih]

data_uji <- diff1[(n_latih + 1):n_total]

cat("Jumlah total data stasioner:", n_total, "\n")
cat("Jumlah data latih (80%):", length(data_latih), "\n")
cat("Jumlah data uji (20%):", length(data_uji), "\n")
```

```{r}
mean(data_latih)
var(data_latih)
```

## Plot Time Series
```{r}
plot_df <- tibble(
  Observasi = 1:length(data_latih),
  Nilai = data_latih
)

plot_df |>
  as_tsibble(index = Observasi) |>
  ggplot(aes(x = Observasi, y = Nilai)) +
  geom_line(color = "blue") +
  geom_hline(yintercept = 0, color = "red", linetype = "dashed") +
  theme_bw() +
  labs(
    title = "Time Series Plot Data Latih (Setelah Differencing)",
    x = "Observasi",
    y = "Nilai Differencing"
  )
```
Plot ini menunjukkan bahwa data latih ini sudah stasioner, karena tidak lagi memiliki tren yang jelas dan nilainya berfluktuasi secara konstan di sekitar rata-rata nol.

## Uji ADF

```{r}
adf.test(data_latih)
```

Karena $p-value$ (0.01) jauh lebih kecil dari tingkat signifikansi umum (0.05), kita memiliki bukti statistik yang kuat untuk menolak Hipotesis Nol. Sehingga dapat disimpulkan bahwa data_latih ini stasioner.

## Plot ACF

```{r}
acf(data_latih)
```
Plot ACF ini menunjukkan pola "cut off" setelah lag ke-3, yang mengindikasikan bahwa model Moving Average (MA) mungkin cocok untuk data ini. Nilai yang paling mungkin untuk orde MA (q) adalah 3.

## Plot PACF

```{r}
pacf(data_latih)
```
Plot PACF ini menunjukkan pola "cut off" setelah lag ke-3, yang mengindikasikan bahwa model AutoRegressive (AR) mungkin cocok untuk data Anda. Nilai yang paling mungkin untuk orde AR (p) adalah 3.













